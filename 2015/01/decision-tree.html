<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Jiye Qian" />
    <title>åˆ†ç±»å™¨èåˆï¼ˆ3ï¼‰ï¼šå†³ç­–æ ‘</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <link href="/feed/" rel="alternate" title="Jiye Qian" type="application/atom+xml" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <link rel="stylesheet" href="/assets/css/pygments/default.css" />
    <link rel="stylesheet" href="/assets/css/pygments/default_inline.css" />
    <link rel="stylesheet" href="/assets/css/coderay.css" />
    <link rel="stylesheet" href="/assets/css/twemoji-awesome.css" />  
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link href="/assets/css/jquery-ui-1.10.4.custom.min.css" rel="stylesheet" />
    <link href="/assets/css/ggvis.css" rel="stylesheet" />
    <link href="/assets/css/mermaid.css" rel="stylesheet" />
    <link rel="stylesheet" href="/assets/css/markdown-plus.css"/> 
    <link rel="stylesheet" href="/assets/css/flexslider.css" type="text/css" media="screen" />
      <style type="text/css">
        .flex-caption {
          width: 96%;
          padding: 2%;
          left: 0;
          bottom: 0;
          background: rgba(0,0,0,.5);
          color: #fff;
          text-shadow: 0 -1px 0 rgba(0,0,0,.3);
          font-size: 14px;
          line-height: 18px;
        }
        li.css a {
          border-radius: 0;
        }
      </style>

    <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery-ui-1.10.4.custom.min.js"></script>
    <script type="text/javascript" src="/assets/js/d3.min.js"></script>
    <script type="text/javascript" src="/assets/js/vega.min.js"></script>
    <script type="text/javascript" src="/assets/js/lodash.min.js"></script>
    <script>var lodash = _.noConflict();</script>
    <script type="text/javascript" src="/assets/js/ggvis.js"></script>
    <script type="text/javascript" src="/assets/js/htmlwidgets.js"></script>
    <script type="text/javascript" src="/assets/js/echarts-all.js"></script>
    <script type="text/javascript" src="/assets/js/echarts.js"></script>
    <script defer src="/assets/js/jquery.flexslider-min.js"></script>
    <script type="text/javascript">
      // $(function(){
      //   SyntaxHighlighter.all();
      // });
      $(window).load(function(){
        $('.flexslider').flexslider({
          animation: "slide",
          start: function(slider){
            $('body').removeClass('loading');
          }
        });
      });
    </script>

    <script type="text/javascript">
      function setTimeSpan(){
        var date = new Date();
        timeSpan.innerText=date.format('yyyy-MM-dd hh:mm:ss');
      }

      Date.prototype.format = function(format)
      {
        var o =
        {
          "M+" : this.getMonth()+1, //month
          "d+" : this.getDate(),    //day
          "h+" : this.getHours(),   //hour
          "m+" : this.getMinutes(), //minute
          "s+" : this.getSeconds(), //second
          "q+" : Math.floor((this.getMonth()+3)/3),  //quarter
          "S" : this.getMilliseconds() //millisecond
        }
        if(/(y+)/.test(format))
          format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
          if(new RegExp("("+ k +")").test(format))
            format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
          return format;
        }
      </script>

    <!-- MathJax for LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        "HTML-CSS": { extensions: ["handle-floats.js"] },
        TeX: { equationNumbers: { autoNumber: "AMS" } },
        tex2jax: {
            inlineMath: [['$$$', '$$$'], ['$', '$'], ['\\(', '\\)']],
            processEscapes: true
        }
    });
    </script>
    <!-- <script type="text/javascript" src="/assets/js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <!-- <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F0b514f17fd99b9fb4be74c94bdd2b7db' type='text/javascript'%3E%3C/script%3E"));
</script>
 -->
  </head>
<!--  <body>
-->

  <body onLoad="setInterval(setTimeSpan,1000);">
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>åˆ†ç±»å™¨èåˆï¼ˆ3ï¼‰ï¼šå†³ç­–æ ‘</h1>
        </header>
        <nav id="real_nav">
        
          <span><a title="Home" href="/">Home</a></span>
        
          <span><a title="Categories" href="/categories/">Categories</a></span>
        
          <span><a title="Tags" href="/tags/">Tags</a></span>
        
          <span><a title="About" href="/about/">About</a></span>
        
          <span><a title="Search" href="/search/">Search</a></span>
        
        </nav>
        <article class="content">
        <script type="text/javascript" src="/assets/js/outliner.js"></script>

<section class="meta">
<span class="time">
  <time datetime="2015-01-23">2015-01-23</time>
</span>

 |
<span class="categories">
  <i class="fa fa-share-alt"></i>
  
  <a href="/categories/#ç ”ç©¶å­¦æœ¯" title="ç ”ç©¶å­¦æœ¯">ç ”ç©¶å­¦æœ¯</a>&nbsp;
  
</span>


 |
<span class="tags">
  <i class="fa fa-tags"></i>
  
  <a href="/tags/#æœºå™¨å­¦ä¹ åŸºç¡€" title="æœºå™¨å­¦ä¹ åŸºç¡€">æœºå™¨å­¦ä¹ åŸºç¡€</a>&nbsp;
  
  <a href="/tags/#åˆ†ç±»å™¨èåˆ" title="åˆ†ç±»å™¨èåˆ">åˆ†ç±»å™¨èåˆ</a>&nbsp;
  
  <a href="/tags/#ç‰¹å¾é€‰æ‹©" title="ç‰¹å¾é€‰æ‹©">ç‰¹å¾é€‰æ‹©</a>&nbsp;
  
  <a href="/tags/#ç†µ" title="ç†µ">ç†µ</a>&nbsp;
  
  <a href="/tags/#æ­£åˆ™åŒ–" title="æ­£åˆ™åŒ–">æ­£åˆ™åŒ–</a>&nbsp;
  
</span>

</section>
<section class="post">
<h2 id="section">å†³ç­–æ ‘ç®€ä»‹</h2>

<p>å†³ç­–æ ‘æ˜¯ä¸€ç§å¯¹å®ä¾‹åˆ†ç±»çš„æ ‘å½¢ç»“æ„ï¼Œç”±èŠ‚ç‚¹ï¼ˆnodeï¼‰å’Œæœ‰å‘è¾¹ï¼ˆdirected edgeï¼‰ç»„æˆï¼Œå†…éƒ¨èŠ‚ç‚¹ï¼ˆinternal nodeï¼‰è¡¨ç¤ºç‰¹å¾æˆ–å±æ€§ï¼Œå¶èŠ‚ç‚¹ï¼ˆleaf nodeï¼‰è¡¨ç¤ºç±»<a href="#lihang_sml_2012">[1, P. 55]</a>ã€‚å†³ç­–æ ‘æ—¢å¯ä»¥çœ‹æˆif-thenè§„åˆ™çš„é›†åˆï¼Œä¹Ÿå¯è¡¨ç¤ºç»™å®šç‰¹å¾æ¡ä»¶ä¸‹ç±»åˆ«çš„æ¦‚ç‡å¯†åº¦åˆ†å¸ƒ<a href="#lihang_sml_2012">[1, P. 56]</a>ã€‚ä»åˆ†ç±»å™¨èåˆçš„è§’åº¦ï¼Œå†³ç­–æ ‘æ˜¯ä¸€ç§<a href="/2015/01/blending-and-bagging/#mjx-eqn-eqconditional-blending-hypothesis">æœ‰æ¡ä»¶åˆ†ç±»å™¨èåˆ</a>çš„å­¦ä¹ æ¨¡å‹<a href="#lin_ml_dt_2015">[2]</a>ã€‚å¸¸ç”¨çš„å†³ç­–æ ‘å­¦ä¹ ç®—æ³•æœ‰ID3ã€C4.5å’ŒC&amp;RTï¼ˆä¹Ÿè®°ä¸ºCARTï¼‰ã€‚</p>

<p>å†³ç­–æ ‘åœ¨å®é™…ä¸­å¾ˆæœ‰ç”¨ï¼Œå®ƒå¯è§£é‡Šæ€§å¼ºï¼ˆå¹¿æ³›åº”ç”¨äºå•†ä¸šå’ŒåŒ»å­¦æ•°æ®åˆ†æï¼‰ï¼Œç®€å•å®¹æ˜“å®ç°ï¼Œèƒ½é«˜æ•ˆçš„å­¦ä¹ å’Œé¢„æµ‹ï¼Œä½†æ˜¯å®ƒæ˜¯å¯å‘å¼æ–¹æ³•ï¼Œç†è®ºåŸºç¡€è¾ƒè–„å¼±ã€‚</p>

<div class="image_line" id="figure-1"><div class="image_card"><a href="/assets/images/2015-01-23-decision-tree-decision-tree-example.png"><img src="/assets/images/2015-01-23-decision-tree-decision-tree-example.png" alt="ï¼»å·¦ï¼½ï¼šè§‚çœ‹MOOCè¯¾ç¨‹çš„å†³ç­–æ ‘ï¼»å³ï¼½ï¼šé€’å½’å®šä¹‰çš„å†³ç­–æ ‘ç®—æ³•" /></a><div class="caption">å›¾ 1:  ï¼»å·¦ï¼½ï¼šè§‚çœ‹MOOCè¯¾ç¨‹çš„å†³ç­–æ ‘ï¼»å³ï¼½ï¼šé€’å½’å®šä¹‰çš„å†³ç­–æ ‘ç®—æ³• [<a href="/assets/images/2015-01-23-decision-tree-decision-tree-example.png">PNG</a>]</div></div></div>

<p>ä¸Šå›¾å·¦çš„å†³ç­–æ ‘ç”¨æ¥åˆ¤æ–­æ˜¯å¦è§‚çœ‹MOOCè¯¾ç¨‹ã€‚å†³ç­–æ ‘æ˜¯åˆ†ç±»å™¨çš„æœ‰æ¡ä»¶èåˆï¼Œåœ¨ä¸åŒæ¡ä»¶é‡‡ç”¨ä¸åŒçš„$g_t(\mathbf x)$ï¼š</p>

<ul>
  <li>åŸºæœ¬å‡è®¾ï¼ˆbase hypothesisï¼‰$g_t(\mathbf x)$ï¼šæ¯æ¡è·¯å¾„ç»ˆç‚¹çš„å¶å­ğŸƒï¼Œæ­¤å¤„æ˜¯å¸¸æ•°ã€‚</li>
  <li>æ¡ä»¶$q_t(\mathbf x)$ï¼šæ¯æ¡è·¯å¾„çš„å†…éƒ¨èŠ‚ç‚¹ï¼Œ$\mathbf x$åœ¨è·¯å¾„$t$ä¸Šä¹ˆï¼Ÿä¸Šå›¾å·¦ä¸­è±å½¢åŒºåŸŸã€‚</li>
</ul>

<p>å†³ç­–æ ‘æ˜¯é€’å½’ç»“æ„ï¼Œæ¯ä¸ªåˆ†æ”¯å¯¹åº”ä¸€é¢—å­å†³ç­–æ ‘
\[
G(\mathbf x)=\sum_{c=1}^C[[b(\mathbf x)=c]]\cdot G_c(\mathbf x)ï¼Œ
\]
$b(\mathbf x)$è¡¨ç¤ºåˆ†æ”¯æ¡ä»¶ï¼Œ$G_c(\mathbf x)$è¡¨ç¤ºç¬¬$c$ä¸ªåˆ†æ”¯çš„å­æ ‘ã€‚</p>

<p>ä¸Šå›¾å³å±•ç¤ºäº†é€’å½’æ–¹å¼å®šä¹‰çš„å†³ç­–æ ‘ç®—æ³•ï¼Œä»ä¸­å¯ä»¥çœ‹å‡ºï¼Œæœ‰4ä¸ªæ–¹é¢éœ€è¦å†³å®šï¼šåˆ†æ”¯æ•°ç›®ã€åˆ†æ”¯æ¡ä»¶ã€ç»ˆæ­¢æ¡ä»¶ã€åŸºæœ¬å‡è®¾ã€‚</p>

<h2 id="section-1">ç‰¹å¾é€‰æ‹©</h2>

<p>å¦‚æœç‰¹å¾æ•°ç›®è¿‡å¤šï¼Œè®¡ç®—å¤æ‚åº¦è¿‡å¤§ï¼Œå¯ä»¥åœ¨å†³ç­–æ ‘å­¦ä¹ ä¹‹å‰è¿›è¡Œç‰¹å¾é€‰æ‹©ï¼Œåªé€‰æ‹©å¯¹è®­ç»ƒæ•°æ®æœ‰è¶³å¤Ÿåˆ†ç±»èƒ½åŠ›çš„ç‰¹å¾ã€‚å¦‚æœåˆ©ç”¨ä¸€ä¸ªç‰¹å¾è¿›è¡Œåˆ†ç±»çš„ç»“æœä¸éšæœºåˆ†ç±»ç»“æœæ²¡æœ‰å¾ˆå¤§å·®åˆ«ï¼Œåˆ™è¿™ä¸ªç‰¹å¾æ²¡æœ‰åˆ†ç±»èƒ½åŠ›ã€‚é€šå¸¸ç‰¹å¾é€‰æ‹©çš„å‡†åˆ™æ˜¯ä¿¡æ¯å¢ç›Šæˆ–ä¿¡æ¯å¢ç›Šæ¯”<a href="#lihang_sml_2012">[1, Pp. 58-63]</a>ã€‚</p>

<p><strong>ç†µ</strong>ï¼ˆentropyï¼‰è¡¨ç¤ºéšæœºå˜é‡ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œç†µè¶Šå¤§éšæœºå˜é‡çš„ä¸ç¡®å®šæ€§å°±è¶Šå¤§ã€‚æŸä¸€ç»´çš„ç‰¹å¾$x$çš„æ¦‚ç‡è®°ä¸º$p(x)$ï¼Œç‰¹å¾$x$çš„ç†µè¡¨ç¤ºä¸º
\begin{equation}
H(p)=-\sum_{j=1}^Mp(x_j)\log p(x_j)ï¼Œ
\end{equation}
$M$è¡¨ç¤ºç‰¹å¾$X$èƒ½å–ä¸åŒç‰¹å¾å€¼çš„ä¸ªæ•°ã€‚å¯¹æ•°ä»¥2ä¸ºåº•æˆ–ä»¥eä¸ºåº•æ—¶ç†µçš„å•ä½åˆ†åˆ«ç§°ä¸ºæ¯”ç‰¹ï¼ˆbitï¼‰æˆ–çº³ç‰¹ï¼ˆnatï¼‰ã€‚ä»å®šä¹‰å¯çŸ¥$0\leq H(p)\leq \log M$ã€‚<strong>æ¡ä»¶ç†µ</strong>ï¼ˆconditional entropyï¼‰$H(Y|X)$è¡¨ç¤ºå·²çŸ¥éšæœºå˜é‡$X$çš„æ¡ä»¶ä¸‹ï¼Œéšæœºå˜é‡$Y$çš„ä¸ç¡®å®šæ€§ï¼Œå®šä¹‰ä¸ºç»™å®š$X$æ¡ä»¶ä¸‹$Y$çš„æ¡ä»¶æ¦‚ç‡åˆ†å¸ƒçš„ç†µå¯¹$X$çš„æ•°å­¦æœŸæœ›
\begin{equation}
H(Y|X)=-\sum_{j=1}^Mp(x_j)H(Y|X=x_j)ã€‚
\end{equation}
å½“ç†µå’Œæ¡ä»¶ç†µä¸­çš„æ¦‚ç‡ç”±æ•°æ®ä¼°è®¡ï¼ˆç‰¹åˆ«æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ï¼‰å¾—åˆ°æ—¶ï¼Œç†µå’Œæ¡ä»¶ç†µåˆ†åˆ«ç§°ä¸º<strong>ç»éªŒç†µ</strong>ï¼ˆempirical entropyï¼‰å’Œ<strong>ç»éªŒæ¡ä»¶ç†µ</strong>ï¼ˆempirical conditional entropyï¼‰ã€‚è‹¥æœ‰$0$æ¦‚ç‡ï¼Œä»¤$0\log 0=0$ã€‚<strong>ä¿¡æ¯å¢ç›Š</strong>ï¼ˆinformation gainï¼‰è¡¨ç¤ºå¾—çŸ¥ç‰¹å¾$X$è€Œä½¿ç±»$Y$ä¿¡æ¯ä¸ç¡®å®šæ€§å‡å°‘çš„ç¨‹åº¦ã€‚ç‰¹å¾$A$å¯¹è®­ç»ƒé›†$\mathcal D$çš„ä¿¡æ¯å¢ç›Šå®šä¹‰ä¸º
\begin{equation}
g(\mathcal D,A)=H(\mathcal D)-H(\mathcal D|A)ï¼Œ
\end{equation}
ç»éªŒç†µ$H(\mathcal D)$è¡¨ç¤ºå¯¹$\mathcal D$åˆ†ç±»çš„ä¸ç¡®å®šæ€§ï¼Œç»éªŒæ¡ä»¶ç†µ$H(\mathcal D|A)$è¡¨ç¤ºåœ¨ç»™å®šç‰¹å¾$A$æ—¶å¯¹$\mathcal D$åˆ†ç±»çš„ä¸ç¡®å®šåº¦ã€‚æ˜¾ç„¶ï¼Œä¿¡æ¯å¢ç›Šå¤§çš„ç‰¹å¾å…·æœ‰æ›´å¼ºçš„åˆ†ç±»èƒ½åŠ›ã€‚</p>

<p>å½“æ•°æ®é›†çš„ç»éªŒç†µå¾ˆå¤§æ—¶ï¼Œä¿¡æ¯å¢ç›Šä¹Ÿä¼šåå¤§ï¼Œä½¿ç”¨<strong>ä¿¡æ¯å¢ç›Šæ¯”</strong>ï¼ˆinformation gain ratioï¼‰
\begin{equation}
g_R(\mathcal D,A)={g(\mathcal D,A)\over H(\mathcal D)}ï¼Œ
\end{equation}
å¯æ ¡æ­£è¿™ä¸€é—®é¢˜ã€‚</p>

<p>$|\mathcal D|$è¡¨ç¤º$\mathcal D$çš„æ ·æœ¬å®¹é‡ï¼ˆæ ·æœ¬ä¸ªæ•°ï¼‰ï¼Œ$|\mathcal C_k|$è¡¨ç¤ºç±»$\mathcal C_k$çš„æ ·æœ¬ä¸ªæ•°ï¼Œ$\sum_{k=1}^K|\mathcal C_k|=|\mathcal D|$ã€‚æ ¹æ®ç‰¹å¾$A$çš„å–å€¼ï¼Œå°†$\mathcal D$åˆ’åˆ†ä¸º$M$ä¸ªå­é›†$\mathcal D_1,\mathcal D_1,\ldots,\mathcal D_M$ï¼Œå­é›†$\mathcal D_{j}$ä¸­å±äºç±»åˆ«$\mathcal C_k$çš„æ ·æœ¬é›†ä¸º$\mathcal D_{jk}$ï¼Œ$\mathcal D_{jk}=\mathcal D_{j}\cap \mathcal C_k$ã€‚ç»éªŒç†µå’Œç»éªŒæ¡ä»¶ç†µè®¡ç®—æ–¹å¼ä¸º
\begin{equation}
H(\mathcal D)=-\sum_{k=1}^K{|\mathcal C_k|\over |\mathcal D|}\log_2{|\mathcal C_k|\over |\mathcal D|}ï¼Œ\quad H(\mathcal D,A)=-\sum_{j=1}^M{|\mathcal D_j|\over |\mathcal D|}\sum_{k=1}^K{|\mathcal D_{jk}|\over |\mathcal D_j|}\log_2{|\mathcal D_{jk}|\over |\mathcal D_j|}ã€‚
\end{equation}</p>

<p>æ ¹æ®å¦‚ä¸‹è´·æ¬¾æ•°æ®è¡¨</p>

<p><img src="/assets/images/2015-01-23-decision-tree-loan-table.png" alt="è´·æ¬¾æ•°æ®è¡¨" /></p>

<p>åˆ©ç”¨ä¿¡æ¯å¢ç›Šå‡†åˆ™å¯ä»¥é€‰å‡ºæœ€ä¼˜ç‰¹å¾ã€‚ç”±è¡¨ä¸­æ•°æ®è®¡ç®—ç»éªŒç†µ
\[
H(\mathcal D)=-{9\over 15}\log_2{9\over 15}-{6\over 15}\log_2{6\over 15}=0.971ï¼Œ
\]
å¹´é¾„ç‰¹å¾å¯¹æ•°æ®é›†$\mathcal D$çš„ç»éªŒæ¡ä»¶ç†µä¸º
\begin{aligned}
H(\mathcal D,å¹´é¾„)=
&amp;-{5\over 15}\left({2\over 5}\log_2{2\over 5}+{3\over 5}\log_2{3\over 5}\right)\\
&amp;-{5\over 15}\left({3\over 5}\log_2{3\over 5}+{2\over 5}\log_2{2\over 5}\right)\\
&amp;-{5\over 15}\left({4\over 5}\log_2{4\over 5}+{1\over 5}\log_2{1\over 5}\right)=0.888ï¼Œ
\end{aligned}
å¹´é¾„ç‰¹å¾å¯¹æ•°æ®é›†$\mathcal D$çš„ä¿¡æ¯å¢ç›Šä¸º$g(\mathcal D,å¹´é¾„)=0.971-0.888=0.083$ï¼ŒåŒæ ·å¯å¾—å…¶å®ƒä¿¡æ¯å¢ç›Šä¸º
\[
g(\mathcal D,æœ‰å·¥ä½œ)=0.324ï¼Œ\quad g(\mathcal D,æœ‰è‡ªå·±çš„æˆ¿å­)=0.420ï¼Œ\quad g(\mathcal D,å€Ÿè´·æƒ…å†µ)=0.363ï¼Œ
\]
ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾â€œæœ‰è‡ªå·±çš„æˆ¿å­â€æ˜¯æœ€ä¼˜ç‰¹å¾ã€‚</p>

<h2 id="section-2">åˆ†ç±»å›å½’æ ‘</h2>

<p>åˆ†ç±»å›å½’æ ‘ï¼ˆC&amp;RTï¼Œclassification and regression treeï¼‰æ—¢å¯ç”¨äºåˆ†ç±»åˆå¯ç”¨äºå›å½’ã€‚å®ƒæ˜¯äºŒå‰æ ‘ï¼Œ<strong>åˆ†æ”¯æ•°ç›®</strong>$C=2$ï¼Œ<strong>åŸºæœ¬å‡è®¾</strong>$g_t(\mathbf x)$è¿”å›$E_{in}$æœ€ä¼˜æ—¶çš„å¸¸æ•°ã€‚C&amp;RTçš„$g_t(\mathbf x)$æ¯”è¾ƒç®€å•ï¼š</p>

<ul>
  <li>äºŒåˆ†ç±»æˆ–å¤šåˆ†ç±»é—®é¢˜ï¼ˆåŸºäº0ï¼1è¯¯å·®åº¦é‡$E_{in}$ï¼‰ï¼š$\{y_n\}$ä¸­å å¤§å¤šæ•°çš„ç±»çš„æ ‡ç­¾ï¼›</li>
  <li>å›å½’é—®é¢˜ï¼ˆåŸºäºå¹³æ–¹è¯¯å·®åº¦é‡$E_{in}$ï¼‰ï¼š$\{y_n\}$çš„å‡å€¼ã€‚</li>
</ul>

<p>C&amp;RTç”¨<a href="/2015/01/adaptive-boosting/#mjx-eqn-eqdecision-stump">decision stump</a>è¿›è¡ŒäºŒå…ƒåˆ†æ”¯ï¼Œåˆ©ç”¨æ•°æ®é›†å¤§å°åŠ æƒçš„ä¸çº¯åº¦ä½œä¸º<strong>åˆ†æ”¯æ¡ä»¶</strong>ï¼Œ
\begin{equation}
b(\mathbf x)=\underset{\mbox{decision stumps }h(\mathbf x)}{\arg\min}\sum_{c=1}^2|\mathcal D_c\mbox{ with }h|\cdot\mbox{impurity}(\mathcal D_c\mbox{ with }h)ï¼Œ
\label{eq:dtree-decision-stump}
\end{equation}
é€‰æ‹©åŠ æƒä¸çº¯åº¦æœ€å°çš„åˆ†æ”¯æ–¹æ³•ã€‚è‹¥ç”¨decision stumpå¯¹æœ‰$m$ä¸ªä¸åŒçš„å–å€¼çš„ç‰¹å¾è¿›è¡Œåˆ’åˆ†ï¼Œå¯¹æœ‰åºçš„ç‰¹å¾å…±æœ‰$m-1$ç§äºŒåˆ†æ³•ï¼Œå¯¹æ— åºçš„ç‰¹å¾å…±æœ‰$2^{m-1}-1$ç§äºŒåˆ†æ³•<a href="#wires11">[3, Pp. 14-15]</a>ã€‚å›å½’çš„ä¸çº¯åº¦é‡‡ç”¨å›å½’è¯¯å·®
\begin{equation}
\mbox{impurity}(\mathcal D)={1\over N}\sum_{n=1}^N(y_n-\bar y)^2ï¼Œ
\end{equation}
$\bar y$è¡¨ç¤º$\{y_n\}$çš„å‡å€¼ã€‚åˆ†ç±»çš„ä¸çº¯åº¦å¯é‡‡ç”¨åˆ†ç±»è¯¯å·®
\begin{equation*}
\mbox{impurity}(\mathcal D)={1\over N}\sum_{n=1}^N[[y_n\neq y^*]]ï¼Œ
\end{equation*}
$y^*$è¡¨ç¤º$\{y_n\}$ä¸­å å¤§å¤šæ•°çš„ç±»çš„æ ‡ç­¾ï¼Œä½†é€šå¸¸é‡‡ç”¨çš„æ˜¯GiniæŒ‡æ•°
\begin{equation}
\mbox{impurity}(\mathcal D)=1-\sum_{k=1}^K\left({\sum_{n=1}^N[[y_n=k]]\over N}\right)^2ï¼Œ
\end{equation}
$k$è¡¨ç¤ºç±»æ ‡ç­¾ï¼Œ${\sum_{n=1}^N[[y_n=k]]\over N}$å°±æ˜¯ç±»$k$åœ¨$\mathcal D$ä¸­å çš„æ¯”ç‡ï¼Œä¹Ÿå¯é‡‡ç”¨
\begin{equation*}
\mbox{impurity}(\mathcal D)=1-\max_{1\leq k\leq K}{\sum_{n=1}^N[[y_n=k]]\over N}ã€‚
\end{equation*}
$\mathcal D$ä¸­çš„ç±»è¶Šåˆ†æ•£ä¸çº¯åº¦è¶Šé«˜ï¼Œç±»ä¼¼äºç†µï¼›$\mathcal D$ä¸­æ•°æ®å±äºåŒä¸€ç±»æ—¶ä¸çº¯åº¦ä¸º0ã€‚</p>

<p>åˆ†ç±»å›å½’æ ‘â€œè¢«è¿«â€åœæ­¢ç”Ÿé•¿çš„ä¸¤ä¸ª<strong>ç»ˆæ­¢æ¡ä»¶</strong>ï¼š</p>

<ol>
  <li>æ‰€æœ‰$y_n$éƒ½ç›¸åŒï¼Œä¸çº¯åº¦ä¸º0ï¼Œè¿”å›$g_t(\mathbf x)=y_n$ï¼›</li>
  <li>æ‰€æœ‰$\mathbf x_n$éƒ½ç›¸åŒï¼Œä¸å­˜åœ¨decision stumpã€‚</li>
</ol>

<p>è¿™ç§è¢«è¿«åœæ­¢ç”Ÿé•¿çš„æ ‘ç§°ä¸ºå®Œå…¨æˆé•¿æ ‘ï¼ˆfully-grown treeï¼‰ã€‚</p>

<p>C&amp;RT = å®Œå…¨æˆé•¿æ ‘ ï¼‹ å¸¸æ•°å¶å­ğŸƒ ï¼‹ äºŒå…ƒåˆ†æ”¯ ï¼‹ çº¯åŒ–ã€‚</p>

<h2 id="section-3">å†³ç­–æ ‘å‰ªæ</h2>

<p>å¦‚æœæ‰€æœ‰çš„$\mathbf x_n$éƒ½ä¸åŒï¼Œå®Œå…¨æˆé•¿çš„å†³ç­–æ ‘ä½¿å¾—$E_{in}(G)=0$ï¼Œè¿™ä¼šå¯¼è‡´è¿‡æ‹Ÿåˆï¼ˆ$E_{out}$å¾ˆå¤§ï¼‰ï¼Œå› ä¸ºåº•å±‚çš„æ ‘å»ºç«‹åœ¨å¾ˆå°çš„æ•°æ®é›†$\mathcal D_c$ä¸Šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå†³ç­–æ ‘çš„varianceè¾ƒå¤§ï¼Œæ•°æ®å¾ˆå°çš„æ”¹å˜å°±å¯èƒ½å¾—åˆ°å¾ˆä¸ä¸€æ ·çš„å†³ç­–æ ‘ã€‚</p>

<p>å†³ç­–æ ‘éœ€è¦æ­£åˆ™åŒ–æœºåˆ¶é¿å…è¿‡æ‹Ÿåˆã€‚åˆ©ç”¨æ§åˆ¶æ ‘å¶æ•°ç›®$\Omega(G)$ï¼Œæ­£åˆ™åŒ–å†³ç­–æ ‘
\begin{equation}
\underset{\mbox{all possible }G}{\arg\min}E_{in}(G)+\lambda\Omega(G)ï¼Œ
\end{equation}
ç§°ä¸ºå‰ªæï¼ˆpruningï¼‰ã€‚é€šå¸¸æ˜¯é‡‡ç”¨äº¤å‰éªŒè¯é€‰æ‹©$\lambda$ã€‚è‹¥è¦åˆ—ä¸¾æ‰€æœ‰çš„$G$ï¼Œè®¡ç®—é‡éå¸¸å¤§ï¼Œé€šå¸¸çš„åšæ³•æ˜¯ä»å®Œå…¨æˆé•¿æ ‘å…¥æ‰‹æ„é€ å¯èƒ½çš„$G$ï¼š</p>

<ul>
  <li>$G^{(0)}$ä¸ºå®Œå…¨æˆé•¿æ ‘ï¼›</li>
  <li>$G^{(i)}=\arg\min_GE_{in}(G)$ï¼Œ$G$è¡¨ç¤ºä»$G^{(i-1)}$ä¸­ç§»é™¤ä¸€ç‰‡å¶å­ï¼ˆå®é™…æ˜¯åˆå¹¶å¶å­ï¼Œå°†å¶èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä½œä¸ºæ–°çš„å¶èŠ‚ç‚¹ï¼‰ã€‚</li>
</ul>

<h2 id="section-4">å†³ç­–æ ‘ä¼˜åŠ¿</h2>

<p>å‡ ä¹æ²¡æœ‰å“ªç§å…¶å®ƒçš„æœºå™¨å­¦ä¹ ç®—æ³•æ‹¥æœ‰å¦‚æ­¤å¤šä¼˜è‰¯ç‰¹æ€§ï¼Œé™¤éå…¶å®ƒå†³ç­–æ ‘ã€‚</p>

<h4 id="section-5">ä¸€ã€å¯è§£é‡Šæ€§å¥½</h4>

<h4 id="section-6">äºŒã€å®¹æ˜“å¤„ç†å¤šåˆ†ç±»é—®é¢˜</h4>

<h4 id="section-7">ä¸‰ã€å®¹æ˜“å¤„ç†ç±»åˆ«ç‰¹å¾</h4>

<p>å†³ç­–æ ‘é€šè¿‡decision stump
\begin{equation}
b(\mathbf x)=[[x_i\leq \theta]]+1\quad\theta\in\mathbb Rï¼Œ
\end{equation}
å¯ä»¥å¯¹æ•°å€¼ç‰¹å¾è¿›è¡Œåˆ†ç±»ï¼›åˆ©ç”¨å†³ç­–å­é›†ï¼ˆdecision subsetï¼‰
\begin{equation}
b(\mathbf x)=[[x_i\in S]]+1\quad S\in\{1,2,\ldots,K\}ï¼Œ
\end{equation}
å†³ç­–æ ‘ä¹Ÿå¾ˆå®¹æ˜“è¿›è¡ŒåŸºäºç±»åˆ«ç‰¹å¾çš„åˆ†ç±»<sup id="fnref:categorical-feature"><a href="#fn:categorical-feature" class="footnote">1</a></sup>ã€‚</p>

<h4 id="section-8">å››ã€å®¹æ˜“å¤„ç†é—å¤±ç‰¹å¾</h4>

<p>å‡è®¾æ•°æ®é›†ä¸­é—å¤±äº†ä½“é‡ç‰¹å¾ï¼Œäººå¤„ç†è¿™ç±»é—®é¢˜çš„æ–¹æ³•æœ‰ï¼š</p>

<ul>
  <li>è·å–ä½“é‡ç‰¹å¾ï¼›</li>
  <li>ç”¨èº«é«˜ç‰¹å¾ä»£æ›¿ã€‚</li>
</ul>

<p>å†³ç­–æ ‘åˆ©ç”¨ç±»ä¼¼çš„ä»£æ›¿æ€æƒ³ï¼Œé‡‡ç”¨æ›¿ä»£åˆ†æ”¯ï¼ˆsurrogate branchï¼‰ã€‚åœ¨è®­ç»ƒçš„æ—¶å€™è®­ç»ƒå¯ç”¨çš„æ›¿ä»£åˆ†æ”¯ï¼Œåˆ©ç”¨æ›¿ä»£åˆ†æ”¯å¯ä»¥å¾—åˆ°å’ŒåŸæ¥å·®ä¸å¤šçš„æ•ˆæœã€‚å½“ä½¿ç”¨æ—¶é‡åˆ°ç‰¹å¾é—å¤±ï¼Œåˆ©ç”¨æ›¿ä»£åˆ†æ”¯è§£å†³ã€‚</p>

<h4 id="section-9">äº”ã€é«˜æ•ˆçš„è®­ç»ƒéçº¿æ€§æ¨¡å‹</h4>

<div class="image_line" id="figure-2"><div class="image_card"><a href="/assets/images/2015-01-23-decision-tree-C&amp;RT-vs-AdaBoost.png"><img src="/assets/images/2015-01-23-decision-tree-C&amp;RT-vs-AdaBoost.png" alt="C&amp;RT vs. AdaBoost" /></a><div class="caption">å›¾ 2:  C&amp;RT vs. AdaBoost [<a href="/assets/images/2015-01-23-decision-tree-C&amp;RT-vs-AdaBoost.png">PNG</a>]</div></div></div>

<h2 id="section-10">å‚è€ƒèµ„æ–™</h2>

<ol class="bibliography"><li><span id="lihang_sml_2012">[1]æèˆª, <i>ç»Ÿè®¡å­¦ä¹ æ–¹æ³•</i>. åŒ—äº¬: æ¸…åå¤§å­¦å‡ºç‰ˆç¤¾, 2012.</span>

</li>
<li><span id="lin_ml_dt_2015">[2]H.-T. Lin, â€œLecture 9: Decision Tree.â€ Coursera, 2015.</span>

[<a href="https://class.coursera.org/ntumltwo-001/lecture">Online</a>]

</li>
<li><span id="wires11">[3]W.-Y. Loh, â€œClassification and regression trees,â€ <i>Wiley Interdisciplinary Reviews: Data Mining and Knowledge Discovery</i>, vol. 1, pp. 14â€“23, 2011.</span>

</li></ol>

<h3 id="section-11">è„šæ³¨</h3>

<div class="footnotes">
  <ol>
    <li id="fn:categorical-feature">
      <p>ä¾‹å¦‚åŒ»ç”Ÿè¯Šæ–­æ—¶ä¼šç»™å‡ºç—‡çŠ¶ç›¸å…³çš„ç±»åˆ«ç‰¹å¾ï½›fever, pain, tired, sweatyï½ã€‚ <a href="#fnref:categorical-feature" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

</section>
<section align="left">
<p></p>
<hr>
  <p><img/ src="/assets/images/alipay2me.png" alt="æ‰“èµä½œè€…" style="height: 160px"></p>
  <p></p>
<hr>
  <ul>
    
    <li class="pageNav">2016-09-28 &raquo; <a href="/2016/09/pgm_i_01_introduction_and_overview">PGM Iï¼ˆ01ï¼‰ï¼šå¼•è¨€ä¸æ¦‚è¿°</a></li>
    
    <li class="pageNav">2016-09-24 &raquo; <a href="/2016/09/feasibility-about-home-camera-in-power-syetem-monitoring">å®¶ç”¨ç›‘æ§è®¾å¤‡ç”¨äºç”µç½‘çš„å¯è¡Œæ€§åˆ†æ</a></li>
    
    <li class="pageNav">2016-09-19 &raquo; <a href="/2016/09/feasibility-about-uav-in-cable-tunnel">æ— äººæœºç”µç¼†éš§é“å·¡æ£€å¯è¡Œæ€§è°ƒç ”æŠ¥å‘Š</a></li>
    
    <li class="pageNav">2016-09-18 &raquo; <a href="/2016/09/S13000-Introduction">é²æ£’åŠè‡ªé€‚åº”æ§åˆ¶ï¼ˆ1ï¼‰ï¼šæ¦‚è®º</a></li>
    
    <li class="pageNav">2016-09-13 &raquo; <a href="/2016/09/LeNet-5-Lecun">Gradient-Based Learning Applied to Document Recognition</a></li>
    
    <li class="pageNav">2016-03-15 &raquo; <a href="/2016/03/cs231n_loss-functions-and-optimization">CS231nï¼ˆ3ï¼‰ï¼šæŸå¤±å‡½æ•°ä¸æœ€ä¼˜åŒ–</a></li>
    
    <li class="pageNav">2016-03-14 &raquo; <a href="/2016/03/cs231n_image-classification-pipeline">CS231nï¼ˆ2ï¼‰ï¼šå›¾åƒåˆ†ç±»æµç¨‹</a></li>
    
    <li class="pageNav">2016-02-29 &raquo; <a href="/2016/02/cs231n_introduction-to-computer-vision">CS231nï¼ˆ1ï¼‰ï¼šè®¡ç®—æœºè§†è§‰ç®€ä»‹</a></li>
    
  </ul>
<p></p>
<span>
  <a  href="/2015/01/logistic-regression" class="pageNav" style="float:left"   >ä¸Šä¸€ç¯‡ï¼šlogisticå›å½’ </a>
  &nbsp;&nbsp;&nbsp;
  <a  href="/2015/01/random-forest" class="pageNav" style="float:right"   >ä¸‹ä¸€ç¯‡ï¼šåˆ†ç±»å™¨èåˆï¼ˆ4ï¼‰ï¼šéšæœºæ£®æ— </a>  
</span>
</section>

	<script type="text/javascript">
	var first_image = document.getElementsByClassName("post")[0].getElementsByTagName("img")[0]; 
	if (first_image != undefined) {
	document.getElementsByClassName("ds-thread")[0].setAttribute("data-image", first_image.src);
	}
	</script>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"jiyeqian"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<ul class="ds-recent-visitors" data-num-items="16"></ul>
	<div class="ds-thread"  data-thread-key="/2015/01/decision-tree" 	data-url="http://qianjiye.de/2015/01/decision-tree" data-title="åˆ†ç±»å™¨èåˆï¼ˆ3ï¼‰ï¼šå†³ç­–æ ‘">
	</div>	


<!-- <script type="text/javascript"> -->
<!-- $(function(){ -->
<!--   $(document).keydown(function(e) { -->
<!--     var url = false; -->
<!--         if (e.which == 37 || e.which == 72) {  // Left arrow and H -->
<!--          -->
<!--         url = '/2015/01/logistic-regression'; -->
<!--          -->
<!--         } -->
<!--         else if (e.which == 39 || e.which == 76) {  // Right arrow and L -->
<!--          -->
<!--         <1!-- url = 'http://qianjiye.de/2015/01/random-forest'; --1> -->
<!--         url = '/2015/01/random-forest'; -->
<!--          -->
<!--         } else if (e.which == 75) {  // K -->
<!--           url = '#'; -->
<!--         } else if (e.which == 74) { // J -->
<!--         url = '/2015/01/decision-tree/#timeSpan'; -->
<!--         } -->
<!--         if (url) { -->
<!--             window.location = url; -->
<!--         } -->
<!--   }); -->
<!-- }) -->
<!-- </script> -->

        </article>
      </div>

    <footer>
        <p><small>
            Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> | Copyright 2014 - 2016 by <a href="/about/">Jiye Qian</a> | <span class="label label-info" id="timeSpan"></span></small></p>
    </footer>

    </div>
  </body>
</html>

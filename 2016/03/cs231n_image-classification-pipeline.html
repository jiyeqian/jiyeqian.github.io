<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Jiye Qian" />
    <title>CS231nï¼ˆ2ï¼‰ï¼šå›¾åƒåˆ†ç±»æµç¨‹</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <link href="/feed/" rel="alternate" title="Jiye Qian" type="application/atom+xml" />
    <link rel="stylesheet" href="/assets/css/style.css" />
    <link rel="stylesheet" href="/assets/css/pygments/default.css" />
    <link rel="stylesheet" href="/assets/css/pygments/default_inline.css" />
    <link rel="stylesheet" href="/assets/css/coderay.css" />
    <link rel="stylesheet" href="/assets/css/twemoji-awesome.css" />  
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
    <link href="/assets/css/jquery-ui-1.10.4.custom.min.css" rel="stylesheet" />
    <link href="/assets/css/ggvis.css" rel="stylesheet" />
    <link href="/assets/css/mermaid.css" rel="stylesheet" />
    <link rel="stylesheet" href="/assets/css/markdown-plus.css"/> 
    <link rel="stylesheet" href="/assets/css/flexslider.css" type="text/css" media="screen" />
      <style type="text/css">
        .flex-caption {
          width: 96%;
          padding: 2%;
          left: 0;
          bottom: 0;
          background: rgba(0,0,0,.5);
          color: #fff;
          text-shadow: 0 -1px 0 rgba(0,0,0,.3);
          font-size: 14px;
          line-height: 18px;
        }
        li.css a {
          border-radius: 0;
        }
      </style>

    <script type="text/javascript" src="/assets/js/jquery.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery-ui-1.10.4.custom.min.js"></script>
    <script type="text/javascript" src="/assets/js/d3.min.js"></script>
    <script type="text/javascript" src="/assets/js/vega.min.js"></script>
    <script type="text/javascript" src="/assets/js/lodash.min.js"></script>
    <script>var lodash = _.noConflict();</script>
    <script type="text/javascript" src="/assets/js/ggvis.js"></script>
    <script type="text/javascript" src="/assets/js/htmlwidgets.js"></script>
    <script type="text/javascript" src="/assets/js/echarts-all.js"></script>
    <script type="text/javascript" src="/assets/js/echarts.js"></script>
    <script defer src="/assets/js/jquery.flexslider-min.js"></script>
    <script type="text/javascript">
      // $(function(){
      //   SyntaxHighlighter.all();
      // });
      $(window).load(function(){
        $('.flexslider').flexslider({
          animation: "slide",
          start: function(slider){
            $('body').removeClass('loading');
          }
        });
      });
    </script>

    <script type="text/javascript">
      function setTimeSpan(){
        var date = new Date();
        timeSpan.innerText=date.format('yyyy-MM-dd hh:mm:ss');
      }

      Date.prototype.format = function(format)
      {
        var o =
        {
          "M+" : this.getMonth()+1, //month
          "d+" : this.getDate(),    //day
          "h+" : this.getHours(),   //hour
          "m+" : this.getMinutes(), //minute
          "s+" : this.getSeconds(), //second
          "q+" : Math.floor((this.getMonth()+3)/3),  //quarter
          "S" : this.getMilliseconds() //millisecond
        }
        if(/(y+)/.test(format))
          format=format.replace(RegExp.$1,(this.getFullYear()+"").substr(4 - RegExp.$1.length));
        for(var k in o)
          if(new RegExp("("+ k +")").test(format))
            format = format.replace(RegExp.$1,RegExp.$1.length==1 ? o[k] : ("00"+ o[k]).substr((""+ o[k]).length));
          return format;
        }
      </script>

    <!-- MathJax for LaTeX -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        "HTML-CSS": { extensions: ["handle-floats.js"] },
        TeX: { equationNumbers: { autoNumber: "AMS" } },
        tex2jax: {
            inlineMath: [['$$$', '$$$'], ['$', '$'], ['\\(', '\\)']],
            processEscapes: true
        }
    });
    </script>
    <!-- <script type="text/javascript" src="/assets/js/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <!-- <script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F0b514f17fd99b9fb4be74c94bdd2b7db' type='text/javascript'%3E%3C/script%3E"));
</script>
 -->
  </head>
<!--  <body>
-->

  <body onLoad="setInterval(setTimeSpan,1000);">
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>CS231nï¼ˆ2ï¼‰ï¼šå›¾åƒåˆ†ç±»æµç¨‹</h1>
        </header>
        <nav id="real_nav">
        
          <span><a title="Home" href="/">Home</a></span>
        
          <span><a title="Categories" href="/categories/">Categories</a></span>
        
          <span><a title="Tags" href="/tags/">Tags</a></span>
        
          <span><a title="About" href="/about/">About</a></span>
        
          <span><a title="Search" href="/search/">Search</a></span>
        
        </nav>
        <article class="content">
        <script type="text/javascript" src="/assets/js/outliner.js"></script>

<section class="meta">
<span class="time">
  <time datetime="2016-03-14">2016-03-14</time>
</span>

 |
<span class="categories">
  <i class="fa fa-share-alt"></i>
  
  <a href="/categories/#ç ”ç©¶å­¦æœ¯" title="ç ”ç©¶å­¦æœ¯">ç ”ç©¶å­¦æœ¯</a>&nbsp;
  
</span>


 |
<span class="tags">
  <i class="fa fa-tags"></i>
  
  <a href="/tags/#CNN" title="CNN">CNN</a>&nbsp;
  
  <a href="/tags/#è®¡ç®—æœºè§†è§‰" title="è®¡ç®—æœºè§†è§‰">è®¡ç®—æœºè§†è§‰</a>&nbsp;
  
  <a href="/tags/#æœºå™¨å­¦ä¹ åº”ç”¨" title="æœºå™¨å­¦ä¹ åº”ç”¨">æœºå™¨å­¦ä¹ åº”ç”¨</a>&nbsp;
  
  <a href="/tags/#æœ€è¿‘é‚»ç®—æ³•" title="æœ€è¿‘é‚»ç®—æ³•">æœ€è¿‘é‚»ç®—æ³•</a>&nbsp;
  
  <a href="/tags/#Python" title="Python">Python</a>&nbsp;
  
</span>

</section>
<section class="post">
<p>è¯¾ç¨‹ä½œä¸šé™¤äº†åœ¨è‡ªå·±ç”µè„‘ä¸Šï¼Œä¹Ÿå¯åœ¨ <a href="http://terminal.com">terminal.com</a> ç½‘ç«™ä¸Šå®Œæˆã€‚Python å…¥é—¨å¯å‚è€ƒ Justin Johnson çš„ <a href="http://cs231n.github.io/python-numpy-tutorial/">Python Numpy Tutorial</a>ã€‚</p>

<h2 id="section">ç®€ä»‹</h2>

<p>å›¾åƒåˆ†ç±»æ˜¯è®¡ç®—æœºè§†è§‰çš„æ ¸å¿ƒä»»åŠ¡ï¼Œå®ƒæ ¹æ®å·²çŸ¥çš„ç¡®å®šæ ‡ç­¾é›†ï¼Œä¸ºè¾“å…¥å›¾åƒåˆ†é…ä¸€ä¸ªæ ‡ç­¾ï¼ˆæ ‡ç­¾å°±æ˜¯æ‰€è°“çš„ç±»åˆ«ï¼‰ã€‚å…¶å®ƒä¸€äº›è®¡ç®—æœºè§†è§‰é—®é¢˜ï¼Œæ¯”å¦‚ç›®æ ‡æå–ã€åˆ†å‰²ç­‰ï¼Œéƒ½å¯ä»¥è¢«å½’ç»“åˆ°å›¾åƒåˆ†ç±»ã€‚</p>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-classify.png" alt="" width="400px" id="fig-01" /></p>

<p>RGB å›¾åƒé€šå¸¸ç”¨$[0,255]$ä¹‹é—´çš„æ•´æ•°è¡¨ç¤ºä¸ºä¸‰ç»´æ•°ç»„ã€‚ä¸Šå›¾å±•ç¤ºä¸€ä¸ªå›¾åƒåˆ†ç±»æ¨¡å‹ï¼Œå…¶éš¾ç‚¹åœ¨äºè¦ä»è¿™å †æ•°æ®ä¸­è¯†åˆ«å‡ºçŒ«ã€‚é€šè¿‡è®¡ç®—å±äº4ä¸ªæ ‡ç­¾ï½›ğŸ±ï¼ŒğŸ¶ï¼ŒğŸ©ï¼ŒğŸµï½çš„æ¦‚ç‡ï¼Œä¸ºå›¾åƒåˆ†é…æœ€å¤§æ¦‚ç‡å¯¹åº”çš„æ ‡ç­¾ã€‚æœ¬ä¾‹ä¸­å®½248åƒç´ ï¼Œé«˜400åƒç´ çš„å›¾åƒï¼Œç”¨248Ã—400Ã—3çš„çŸ©é˜µè¡¨ç¤ºã€‚çŸ©é˜µçš„æ¯ä¸ªå…ƒç´ å¯¹åº”ä¸€ä¸ªåƒç´ å€¼ï¼Œå–å€¼æ˜¯0åˆ°255çš„æ•´æ•°ã€‚å…·ä½“æ¥è¯´ï¼Œå›¾åƒåˆ†ç±»çš„ä»»åŠ¡æ˜¯é€šè¿‡è¿™äº›åƒç´ å€¼ï¼Œåˆ©ç”¨è®¡ç®—æœºè§†è§‰ç®—æ³•ï¼Œå¾—åˆ°ç±»åˆ«æ ‡ç­¾ï¼ˆæœ¬ä¾‹è¾“å…¥å›¾ç‰‡çš„ç±»åˆ«æ ‡ç­¾æ˜¯ğŸ±ï¼‰ã€‚</p>

<p><img src="/assets/images/2016-03-14-cs231n_image_classification_pipeline_Deformation.png" alt="" id="fig-02" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>å½¢å˜ä¸ç±»å†…å·®å¼‚</strong></p>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-challenges.jpeg" alt="" id="fig-03" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>å›¾åƒåˆ†ç±»é¢ä¸´çš„ä¸»è¦æŒ‘æˆ˜</strong></p>

<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå›¾åƒåˆ†ç±»çš„æŒ‘æˆ˜æ€§åœ¨äºï¼š</p>

<ul>
  <li>è§†è§’å˜åŒ–ï¼ˆViewpoint Variationï¼‰ï¼›</li>
  <li>å°ºåº¦å˜åŒ–ï¼ˆScale Variationï¼‰ï¼›</li>
  <li>å…‰ç…§ï¼ˆIlluminationï¼‰ï¼›</li>
  <li>å½¢å˜ï¼ˆDeformationï¼‰ï¼›</li>
  <li>é®æŒ¡ï¼ˆOcclusionï¼‰ï¼›</li>
  <li>èƒŒæ™¯æ··æ‚ï¼ˆBackground Clutterï¼‰ï¼›</li>
  <li>ç±»å†…å·®å¼‚ï¼ˆIntraclass Variationï¼‰ï¼›</li>
  <li>â€¦â€¦</li>
</ul>

<p>åŒä¸€å›¾åƒåˆ†ç±»é—®é¢˜è¿˜å¯èƒ½é¢ä¸´å¤šé‡æŒ‘æˆ˜ï¼Œå¥½çš„å›¾åƒåˆ†ç±»æ¨¡å‹åº”å½“èƒ½åº”å¯¹è¿™äº›æŒ‘æˆ˜ã€‚å›¾åƒåˆ†ç±»å™¨å½¢å¦‚ï¼š</p>

<div class="highlight"><pre><code class="language-python"><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">image</span><span class="p">):</span>
    <span class="c"># ???</span>
    <span class="k">return</span> <span class="n">class_label</span></code></pre></div>

<p>å›¾åƒåˆ†ç±»ç®—æ³•ä¸ä¼ ç»Ÿçš„è®¡ç®—æœºç®—æ³•ï¼ˆæ¯”å¦‚æ’åºï¼‰å¼€å‘ä¸åŒã€‚é¦–å…ˆéœ€è¦æœé›†å›¾åƒ<a href="http://cs231n.github.io/assets/trainset.jpg">è®­ç»ƒé›†</a>ï¼›ç„¶åå¼€å‘å­¦ä¹ ç®—æ³•ä»æ ·æœ¬é›†ä¸­å­¦ä¹ ï¼›æœ€åé€šè¿‡é¢„æµ‹ç»“æœè¯„ä¼°ç®—æ³•æ€§èƒ½ã€‚è¿™ç§ä¾èµ–å·²æ ‡æ³¨æ ·æœ¬é›†çš„æ–¹æ³•ç§°ä¸º<strong>æ•°æ®é©±åŠ¨çš„æ–¹æ³•</strong>ï¼ˆdata-driven approachï¼‰ï¼š</p>

<ol>
  <li>è¾“å…¥ï¼šè¾“å…¥åŒ…å«$N$å¼ å›¾åƒï¼Œå·²ç»ç”¨Kä¸ªæ ‡ç­¾ä¹‹ä¸€æ ‡æ³¨äº†æ¯å¼ å›¾åƒï¼Œè¿™ç§°ä¸ºè®­ç»ƒé›†ï¼ˆtraining setï¼‰ã€‚</li>
  <li>å­¦ä¹ ï¼ˆè®­ç»ƒï¼‰ï¼šå¼€å‘å­¦ä¹ ç®—æ³•ï¼Œé€šè¿‡è®­ç»ƒé›†å­¦ä¹ æ¯ç±»çš„æ ·å­ï¼Œè¿™ç§°ä¸ºè®­ç»ƒåˆ†ç±»å™¨ï¼ˆtraining classifierï¼‰æˆ–å­¦ä¹ æ¨¡å‹ï¼ˆlearning a modelï¼‰ã€‚</li>
  <li>è¯„ä¼°ï¼ˆé¢„æµ‹ï¼‰ï¼šè¾“å…¥åˆ†ç±»ç®—æ³•æ²¡æœ‰å­¦ä¹ è¿‡çš„å›¾ç‰‡ï¼Œé€šè¿‡ç®—æ³•é¢„æµ‹æ ‡ç­¾ï¼Œæ ¹æ®é¢„æµ‹å’ŒçœŸå®ç»“æœçš„å¯¹æ¯”è¯„ä¼°ç®—æ³•çš„æ•ˆæœã€‚</li>
</ol>

<div class="highlight"><pre><code class="language-python"><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">train_image</span><span class="p">,</span> <span class="n">train_labels</span><span class="p">):</span>
    <span class="c"># build a model for images -&gt; labels ...</span>
    <span class="k">return</span> <span class="n">model</span>

<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">test_images</span><span class="p">):</span>
    <span class="c"># predict test_labels using the model ...</span>
    <span class="k">return</span> <span class="n">test_labels</span></code></pre></div>

<h2 id="section-1">æœ€è¿‘é‚»åˆ†ç±»å™¨</h2>

<p>æœ€è¿‘é‚»åˆ†ç±»å™¨ï¼ˆNNCï¼ŒNearest Neighbor Classifierï¼‰å®¹æ˜“å®ç°ï¼Œæœ¬æ–‡é€šè¿‡å®ƒä»‹ç»å›¾åƒåˆ†ç±»çš„åŸºæœ¬æ–¹æ³•æµç¨‹ï¼Œä½†æ˜¯åœ¨å®é™…åº”ç”¨ä¸­å¾ˆå°‘ä½¿ç”¨è¯¥æ–¹æ³•ã€‚å¯¹NNCï¼Œ<code>train</code>è®­ç»ƒé˜¶æ®µå°±æ˜¯è®°ä½æ‰€æœ‰çš„å›¾åƒåŠå…¶æ ‡ç­¾ï¼Œ<code>predict</code>é¢„æµ‹é˜¶æ®µå°±æ˜¯è¾“å‡ºæœ€ç›¸ä¼¼å›¾åƒçš„æ ‡ç­¾ã€‚</p>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-nn.jpg" alt="" id="fig-04" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>ï¼»å·¦ï¼½ï¼šCIFAR-10ç¤ºä¾‹å›¾åƒï¼›ï¼»å³ï¼½ï¼šä¸ç¬¬1åˆ—æœ€ç›¸é‚»çš„10å¼ å›¾ç‰‡</strong></p>

<p>å›¾åƒæ•°æ®é›†é‡‡ç”¨<a href="http://www.cs.toronto.edu/~kriz/cifar.html">CIFAR-10</a>ï¼Œå®ƒåŒ…å«å°ºå¯¸32Ã—32çš„60000å¼ å°å›¾ï¼Œæ¯å¼ å›¾ç‰‡å·²ç»è¢«ï½›âœˆï¸ï¼ŒğŸš—ï¼ŒğŸ¦ï¼ŒğŸ±ï¼Œâ€¦â€¦ï½ç­‰10ä¸ªæ ‡ç­¾ä¹‹ä¸€æ ‡æ³¨ï¼Œå¦‚ä¸Šå›¾å·¦æ‰€ç¤ºã€‚60000å¼ å›¾ç‰‡è¢«åˆ†å‰²æˆ50000å¼ å›¾ç‰‡ï¼ˆæ¯ç±»5000å¼ ï¼‰çš„è®­ç»ƒé›†å’Œ10000å¼ å›¾ç‰‡ï¼ˆæ¯ç±»1000å¼ ï¼‰çš„æµ‹è¯•é›†ã€‚</p>

<p>æœ€è¿‘é‚»åˆ†ç±»å™¨è®­ç»ƒåˆ†ç±»å™¨çš„æ–¹æ³•ï¼Œå°±æ˜¯è®°ä½è®­ç»ƒé›†å³å¯ã€‚åœ¨é¢„æµ‹çš„æ—¶å€™ç›´æ¥å’Œè®­ç»ƒé›†ä¸­çš„æ¯å¼ å›¾ç‰‡æ¯”è¾ƒï¼Œå¾—åˆ°è¾“å…¥å›¾åƒä¸è®­ç»ƒé›†ä¸­æœ€ç›¸é‚»é‚£å¼ å›¾ç‰‡çš„æ ‡ç­¾ï¼Œå°†è¯¥æ ‡ç­¾ä½œä¸ºé¢„æµ‹ç»“æœã€‚ä¸Šå›¾å³æ˜¯æœ€è¿‘é‚»åˆ†ç±»å™¨çš„ç»“æœï¼Œå…¶ä¸­ç¬¬8è¡Œï¼Œä¸ç¬¬1åˆ—ğŸæœ€ç›¸é‚»çš„æ˜¯ğŸš—ï¼ŒğŸå°±ä¼šè¢«è¯¯æ ‡è®°ä¸ºğŸš—ã€‚</p>

<p>æœ€è¿‘é‚»ç®—æ³•åº¦é‡ä¸¤å¼ å›¾ç‰‡çš„ç›¸é‚»ç¨‹åº¦ï¼Œé€šå¸¸é‡‡ç”¨åƒç´ å€¼ä¹‹é—´çš„$L_1$è·ç¦»ï¼ˆManhattan Distanceï¼‰æˆ–$L_2$è·ç¦»ï¼ˆEuclidean Distanceï¼‰ï¼š</p>

<p>\[
d_1(\mathbf I_1,\mathbf I_2)=\sum_p\left\lvert\mathbf I_1^p-\mathbf I_2^p\right\rvertï¼›\qquad d_2(\mathbf I_1,\mathbf I_2)=\sqrt{\sum_p\left(\mathbf I_1^p-\mathbf I_2^p\right)^2}ã€‚
\]</p>

<p>åœ¨ CIFAR-10 æ•°æ®é›†ä¸Šï¼Œç”¨$L_1$è·ç¦»å¾—åˆ°çš„åˆ†ç±»æ­£ç¡®ç‡å¤§çº¦æ˜¯38.6%ï¼Œ$L_2$è·ç¦»å¾—åˆ°çš„åˆ†ç±»æ­£ç¡®ç‡å¤§çº¦æ˜¯35.4%ï¼Œé«˜äºéšæœºçŒœæƒ³10%çš„ç²¾åº¦ï¼Œç›®å‰æœ€å…ˆè¿›çš„å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼Œconvolutional neural networksï¼‰<a href="http://www.kaggle.com/c/cifar-10/leaderboard">æ­£ç¡®ç‡åœ¨95%ä»¥ä¸Š</a><sup id="fnref:what-is-kaggle-score"><a href="#fn:what-is-kaggle-score" class="footnote">1</a></sup>ã€‚NNC çš„è®­ç»ƒæ—¶é—´çŸ­ï¼Œä½†æ˜¯æµ‹è¯•æ—¶è€—å¾ˆé•¿ã€‚é€šå¸¸å®é™…åº”ç”¨ä¸­ï¼Œæµ‹è¯•æ—¶è€—æ›´é‡è¦ï¼ŒCNN å°±æ˜¯è®­ç»ƒè€—æ—¶ä½†æµ‹è¯•é«˜æ•ˆã€‚</p>

<p>åœ¨åº¦é‡ä¸¤ä¸ªå‘é‡å·®å¼‚æ—¶ï¼Œ$L_2$çš„æ•ˆæœæ¯”$L_1$ç³Ÿç³•ï¼ˆThat is, the $L_2$ distance prefers many medium disagreements to one big one. ï¼‰ã€‚$L_1$å’Œ$L_2$æ˜¯å¸¸ç”¨çš„ä¸¤ä¸ª<a href="http://planetmath.org/vectorpnorm">pèŒƒæ•°</a>ç‰¹ä¾‹ã€‚</p>

<h2 id="kNN">kæœ€è¿‘é‚»åˆ†ç±»å™¨</h2>

<p>kæœ€è¿‘é‚»åˆ†ç±»å™¨ï¼ˆk-NNï¼Œk-nearest neighbor classifierï¼‰æ˜¯å¯¹æœ€è¿‘é‚»åˆ†ç±»å™¨çš„ç®€å•æ‰©å±•ï¼šä»è®­ç»ƒé›†ä¸­é€‰å‡ºä¸è¾“å…¥å›¾åƒæœ€ç›¸é‚»çš„kå¼ å›¾åƒçš„ç±»åˆ«æ ‡ç­¾ï¼Œé€šè¿‡è¿™kä¸ªæ ‡ç­¾å¯¹è¾“å…¥å›¾åƒçš„ç±»åˆ«æ ‡ç­¾è¿›è¡ŒæŠ•ç¥¨ã€‚k=1æ—¶ï¼Œkæœ€è¿‘é‚»åˆ†ç±»å™¨å’Œæœ€è¿‘é‚»åˆ†ç±»å™¨ç­‰ä»·ã€‚ç›´è§‚ä¸Šç†è§£ï¼Œkæœ€è¿‘é‚»åˆ†ç±»å™¨å–å¤§çš„kå€¼ï¼Œå¯¹åˆ¤åˆ«è¾¹ç•Œæœ‰å¹³æ»‘ä½œç”¨ï¼Œèƒ½æ›´å¥½çš„æŠ—å‡»å™ªå£°å¹²æ‰°ã€‚</p>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-knn.jpeg" alt="" id="fig-05" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>kæœ€è¿‘é‚»åˆ†ç±»å™¨çš„åˆ†ç±»æ•ˆæœ<sup id="fnref:think1"><a href="#fn:think1" class="footnote">2</a></sup></strong></p>

<p>ä¸Šå›¾çš„kæœ€è¿‘é‚»åˆ†ç±»å™¨é‡‡ç”¨çš„æ˜¯$L_2$è·ç¦»ã€‚ä¸Šå›¾ä¸­å¯ä»¥çœ‹åˆ°ï¼Œè“è‰²åŒºåŸŸä¸­çš„å°å—ç»¿è‰²å­¤å²›æ˜¯ç”±äºå™ªå£°ç‚¹å¹²æ‰°å¯¼è‡´çš„ï¼Œè¿™å°†å¯¼è‡´é¢„æµ‹é”™è¯¯ï¼›ä¸Šå›¾å³çš„5-NNä¸å—è¿™äº›å¼‚å¸¸å€¼çš„å¹²æ‰°ï¼Œèƒ½åœ¨æµ‹è¯•é›†ä¸Šå–å¾—è·Ÿå¥½çš„æ³›åŒ–ï¼ˆgeneralizationï¼‰æ•ˆæœã€‚ä¸Šå›¾å³çš„ç°è‰²è¡¨ç¤ºæœ‰äº‰è®®çš„åŒºåŸŸï¼Œåœ¨è¿™äº›åŒºåŸŸè‡³å°‘2ä¸ªç±»åˆ«æ ‡ç­¾éƒ½å¾—åˆ°äº†æœ€é«˜ç¥¨ã€‚</p>

<h2 id="section-2">äº¤å‰éªŒè¯</h2>

<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¦‚ä½•é€‰æ‹©kNNçš„å‚æ•°kå‘¢ï¼Ÿé™¤kä¹‹å¤–ï¼Œè¿˜æœ‰åº¦é‡è·ç¦»çš„$L_1$å’Œ$L_2$ç­‰å…¶å®ƒå‚æ•°éœ€è¦è°ƒèŠ‚ã€‚è¿™äº›å€™é€‰å‚æ•°ç§°ä¸º<strong>è¶…å‚æ•°</strong>ï¼ˆhyperparametersï¼‰ã€‚åœ¨åŸºäºæ•°æ®é©±åŠ¨çš„æœºå™¨å­¦ä¹ ç®—æ³•ä¸­ï¼Œå‚æ•°é€‰æ‹©éå¸¸æ™®éã€‚</p>

<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸èƒ½é‡‡ç”¨æµ‹è¯•é›†é€‰æ‹©å‚æ•°ã€‚å¦‚æœé‡‡ç”¨æµ‹è¯•é›†è°ƒæ•´å‚æ•°ï¼Œåˆ†ç±»å™¨å°±å¯èƒ½å¯¹æµ‹è¯•é›†è¿‡æ‹Ÿåˆï¼ˆoverfitï¼‰ï¼Œå½“æœ€ç»ˆå‘å¸ƒåˆ°åº”ç”¨ç¯å¢ƒï¼Œåˆ†ç±»å™¨çš„æ€§èƒ½å¯èƒ½å¤§æ‰“æŠ˜æ‰£ã€‚ç”¨æµ‹è¯•é›†è°ƒæ•´å‚æ•°ï¼Œç›¸å½“äºæŠŠæµ‹è¯•é›†å½“è®­ç»ƒé›†ä½¿ç”¨ã€‚æµ‹è¯•é›†åªåº”è¯¥åœ¨æœ€ç»ˆæµ‹è¯•åˆ†ç±»å™¨æ³›åŒ–æ€§èƒ½æ—¶ï¼Œè¢«ä½¿ç”¨1æ¬¡ã€‚</p>

<p><img src="/assets/images/2016-03-14_cs231n_image_classification_pipeline_Cross-validation.png" alt="" width="400px" id="fig-06" /></p>

<p>åˆé€‚çš„åšæ³•æ˜¯ä»è®­ç»ƒé›†åˆ†å‰²å‡ºä¸€ä¸ªè¾ƒå°çš„å­é›†ï¼Œä½œä¸ºéªŒè¯é›†ï¼ˆvalidation setï¼‰ã€‚å¯¹CIFAR-10æ•°æ®ï¼Œå¯ä»¥ç”¨49,000ä¸ªå›¾åƒä½œä¸ºè®­ç»ƒé›†ï¼Œåˆ©ç”¨å‰©ä¸‹äº†1,000ä¸ªå›¾åƒä½œä¸ºéªŒè¯é›†è¿›è¡Œå‚æ•°è°ƒèŠ‚ã€‚åœ¨é€‰æ‹©å‚æ•°kçš„æ—¶å€™ï¼Œåœ¨éªŒè¯é›†ä¸Šæµ‹è¯•æ¯ä¸ªkæ¨¡å‹çš„æ€§èƒ½ï¼Œä»ä¸­é€‰æ‹©ä½¿æ€§èƒ½è¾¾åˆ°æœ€å¥½çš„kã€‚é€‰å®škä¹‹åï¼Œåœ¨æµ‹è¯•é›†ä¸Šä»…è¿›è¡Œä¸€æ¬¡æ€§èƒ½è¯„ä¼°ã€‚</p>

<p>å½“è®­ç»ƒé›†åˆæµ‹è¯•é›†è¾ƒå°çš„æ—¶å€™ï¼Œå¯ä»¥é‡‡ç”¨æ›´èªæ˜çš„<a href="/2015/01/validation/#v-fold-cross-validation"><strong>äº¤å‰éªŒè¯</strong></a>ï¼ˆcross-validationï¼‰è¿›è¡Œå‚æ•°é€‰æ‹©ã€‚é€šè¿‡è¯„ä¼°ä¸åŒéªŒè¯é›†ä¸Šçš„å¹³å‡æ€§èƒ½ï¼Œé€‰æ‹©åˆé€‚çš„å‚æ•°ã€‚ä»¥5-foldçš„äº¤å‰éªŒè¯ä¸ºä¾‹ï¼š</p>

<ol>
  <li>å°†è®­ç»ƒé›†åˆ†å‰²ä¸º5ç­‰ä»½ï¼›</li>
  <li>é€‰æ‹©1ä»½ä½œä¸ºéªŒè¯é›†ï¼Œå‰©ä½™çš„4ä»½ç»„æˆè®­ç»ƒé›†ï¼Œåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°å‚æ•°çš„æ€§èƒ½ï¼›</li>
  <li>è½®æµå°†5ä»½ä½œä¸ºè®­ç»ƒé›†ï¼Œå°†5æ¬¡æ€§èƒ½çš„å¹³å‡ä½œä¸ºæœ€ç»ˆè¯„ä¼°ç»“æœã€‚</li>
</ol>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-cvplot.png" alt="" width="400px" id="fig-07" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>5-foldäº¤å‰éªŒè¯é€‰æ‹©å‚æ•°kçš„æ­£ç¡®ç‡æ›²çº¿</strong></p>

<p>ä¸Šå›¾å±•ç¤ºäº†5-foldäº¤å‰éªŒè¯çš„æ•ˆæœï¼Œk=7æ˜¯ä¸ªä¸é”™çš„å‚æ•°ã€‚è‹¥åˆ†å‰²çš„ç­‰ä»½å¤§äº5ï¼Œä¸Šå›¾çš„æ›²çº¿å°†å˜å¾—æ›´åŠ å…‰æ»‘ã€‚</p>

<p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œç”±äºäº¤å‰éªŒè¯è®¡ç®—é‡å¾ˆå¤§ï¼Œå› è€Œä¼šé€‰æ‹©é‡‡ç”¨å•ä¸€éªŒè¯é›†è€Œé¿å…é‡‡ç”¨äº¤å‰éªŒè¯ã€‚é€šå¸¸ç”¨50%åˆ°90%çš„æ•°æ®ä½œä¸ºè®­ç»ƒé›†ï¼Œå‰©ä¸‹çš„ä½œä¸ºéªŒè¯é›†ï¼Œå€™é€‰è¶…å‚æ•°é›†è¶Šå¤§ï¼ŒéªŒè¯é›†è¶Šå¤§ã€‚å½“éªŒè¯é›†å¾ˆå°æ—¶ï¼ˆæ¯”å¦‚ä»…ä»…å‡ ç™¾ä¸ªæ•°æ®ï¼‰ï¼Œé‡‡ç”¨äº¤å‰éªŒè¯æ˜¯æ¯”è¾ƒä¿é™©çš„æ–¹æ³•ï¼Œå®ƒèƒ½å‡å°‘å‚æ•°é€‰æ‹©æ—¶çš„å™ªå£°å¹²æ‰°ï¼Œå¸¸ç”¨çš„æœ‰3-foleã€5-foldã€10-foldäº¤å‰éªŒè¯ã€‚</p>

<p id="is-validation-set-need">å¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯ï¼Œåœ¨é€šè¿‡éªŒè¯é›†ç¡®å®šäº†æœ€ä½³å‚æ•°åï¼Œæ˜¯å¦éœ€è¦åˆ©ç”¨æ•´ä¸ªè®­ç»ƒé›†å’Œæœ€ä½³å‚æ•°é‡æ–°å­¦ä¹ ã€‚ç”±äºæ”¾å›äº†éªŒè¯é›†ï¼Œæ•´ä¸ªè®­ç»ƒé›†ä¸Šçš„è¡¨ç°å¿…ç„¶æœ‰æ‰€ä¸åŒã€‚å®é™…ä¸Šï¼Œæœ€ç»ˆå‘å¸ƒçš„åˆ†ç±»å™¨ä¸éœ€è¦éªŒè¯é›†çš„å‚ä¸ã€‚</p>

<h2 id="section-3">æœ€è¿‘é‚»ç®—æ³•æ¢è®¨</h2>

<p>kæœ€è¿‘é‚»ç®—æ³•çš„ä¸»è¦ä¼˜ç‚¹æ˜¯å®¹æ˜“ç†è§£å’Œå®ç°ï¼Œå¹¶ä¸”è®­ç»ƒä¸æ—¶è€—ï¼›ä¸»è¦ç¼ºç‚¹æ˜¯æµ‹è¯•ï¼ˆé¢„æµ‹ï¼‰æ—¶è€—é«˜ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œä¸»è¦å…³æ³¨çš„æ˜¯æµ‹è¯•ï¼ˆé¢„æµ‹ï¼‰æ—¶è€—ã€‚æ·±åº¦ç¥ç»ç½‘ç»œï¼ˆDNNï¼ŒDeep Neural Networksï¼‰ç›¸åï¼Œè®­ç»ƒè€—æ—¶ä½†é¢„æµ‹é«˜æ•ˆï¼Œåœ¨å®é™…ä¸­æ›´é€‚ç”¨ã€‚</p>

<p>æœ€è¿‘é‚»ç®—æ³•ä¹Ÿæ˜¯ä¸€ä¸ªæ´»è·ƒçš„ç ”ç©¶é¢†åŸŸã€‚è¿‘ä¼¼æœ€è¿‘é‚»ç®—æ³•ï¼ˆANNï¼Œapproximate nearest neighborï¼‰é€šè¿‡å¯¹ç²¾åº¦å’Œé€Ÿåº¦ï¼ˆç©ºé—´ï¼‰è€—è´¹çš„æŠ˜ä¸­æé«˜æ•ˆç‡ï¼Œæ¯”å¦‚<a href="http://www.cs.ubc.ca/research/flann/">FLANN</a>ã€‚è¿™äº›ç®—æ³•é€šå¸¸éœ€è¦é€šè¿‡kdæ ‘æˆ–kå‡å€¼ç®—æ³•é¢„å¤„ç†æˆ–å»ºç«‹ç´¢å¼•ã€‚</p>

<p>kæœ€è¿‘é‚»ç®—æ³•æœ‰æ—¶æ˜¯ä¸é”™çš„é€‰æ‹©ï¼Œå°¤å…¶æ˜¯æ•°æ®ç»´æ•°è¾ƒä½çš„æ—¶å€™ï¼Œä½†åœ¨å›¾åƒåˆ†ç±»ä¸­å‡ ä¹å¾ˆå°‘ä½¿ç”¨ï¼š</p>

<ul>
  <li>å›¾åƒæ˜¯é«˜ç»´æ•°æ®ï¼Œé«˜ç»´ç©ºé—´çš„è·ç¦»åº¦é‡æœ‰äº›åç›´è§‰ï¼ˆcounter-intuitiveï¼‰;</li>
  <li>æµ‹è¯•æ—¶è€—å¤ªé«˜ã€‚</li>
</ul>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-samenorm.png" alt="" id="fig-08" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>å³è¾¹çš„ä¸‰å¼ å›¾ç‰‡å’Œæœ€å·¦çš„ä¸€å¼ çš„$L_2$è·ç¦»å‡ç›¸åŒ</strong></p>

<p>åˆ©ç”¨$L_2$è·ç¦»åº¦é‡ä¸Šå›¾ä¸­å°å›¾çš„ç›¸ä¼¼æ€§ï¼Œç»“æœè¿åç›´è§‰ã€‚å…¶å®ƒå›¾éƒ½æ˜¯æœ€å·¦å›¾å˜æ¢å¾—åˆ°çš„ï¼Œäººçœ¼è§‚å¯Ÿè¿™äº›å›¾æ¯”è¾ƒç›¸ä¼¼ï¼Œä½†æ˜¯åŸºäº$L_2$çš„åº¦é‡è¡¨æ˜å…¶å®ƒå›¾å’ŒåŸå›¾å·®å¼‚å¾ˆå¤§ã€‚å®é™…å±±ï¼Œåƒç´ çº§åˆ«çš„è·ç¦»åº¦é‡æ— æ³•åˆ¤æ–­åŸºäºç›´è§‰å’Œè¯­ä¹‰çš„ç›¸ä¼¼æ€§ã€‚</p>

<p><img src="/assets/images/2015-01-19-image-classification-knn-based-introduction-pixels_embed_cifar10.jpg" alt="" id="fig-09" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>åˆ©ç”¨t-SNEå±•ç¤ºCIFAR-10å›¾åƒ</strong></p>

<p>ä¸Šå›¾ç”¨<a href="http://lvdmaaten.github.io/tsne/">t-SNE</a>å±•ç¤ºCIFAR-10çš„å›¾åƒï¼Œåœ¨åƒç´ çº§çš„$L_2$è·ç¦»åº¦é‡ä¸‹ï¼Œç›¸ä¼¼çš„å›¾åƒç›¸é‚»æ’åˆ—ã€‚ç»“æœè¡¨æ˜å¹¶æ‰€éæ‰€æœŸæœ›çš„é‚£æ ·ï¼ŒåŒç±»åˆ«çš„ç›¸é‚»æ’åˆ—ã€‚å®é™…ä¸Šï¼Œè¿™ç§åº¦é‡ä¸¥é‡å—èƒŒæ™¯å’Œé¢œè‰²åˆ†å¸ƒçš„å½±å“ï¼Œå¹¶éçœŸæ­£åº¦é‡å›¾åƒå†…å®¹çš„ç›¸ä¼¼æ€§ã€‚</p>

<p>kæœ€è¿‘é‚»ç®—æ³•åœ¨å®é™…ä½¿ç”¨ä¸­çš„å»ºè®®ï¼š</p>

<ol>
  <li>æ•°æ®é¢„å¤„ç†ï¼šç‰¹å¾å‘é‡å‡å€¼å½’0åŒ–ã€æ–¹å·®å•ä½åŒ–<sup id="fnref:why-not-here"><a href="#fn:why-not-here" class="footnote">3</a></sup>ï¼›</li>
  <li>å¯¹é«˜ç»´æ•°æ®ç”¨<a href="http://cs229.stanford.edu/notes/cs229-notes10.pdf">PCA</a>æˆ–<a href="http://scikit-learn.org/stable/modules/random_projection.html">éšæœºæŠ•å½±</a>ï¼ˆrandom projectionsï¼‰ç­‰ç®—æ³•é™ç»´å¤„ç†ï¼›</li>
  <li>æ ¹æ®å‰æ–‡å»ºè®®é‡‡ç”¨éªŒè¯ï¼ˆ50%åˆ°90%æ•°æ®ä½œä¸ºè®­ç»ƒé›†ï¼‰æˆ–äº¤å‰éªŒè¯ï¼Œé€šå¸¸foldæ•°è¶Šå¤šï¼Œæ•ˆæœè¶Šå¥½ï¼Œä½†ä¹Ÿè¶Šè€—æ—¶ï¼›</li>
  <li>é€šè¿‡éªŒè¯é›†é€‰æ‹©kï¼ˆå€™é€‰kè¶Šå¤šè¶Šå¥½ï¼‰å’Œè·ç¦»åº¦é‡æ–¹å¼ï¼›</li>
  <li>å¦‚æœç®—æ³•å¤ªè€—æ—¶ï¼Œå°è¯•é‡‡ç”¨ANNåŠ é€Ÿã€‚</li>
</ol>

<h3 id="section-4">ç¤ºä¾‹ä»£ç </h3>

<p>ä¸‹æ–‡ä¸­ä»£ç æ‰€éœ€è¦çš„å‡½æ•°å’Œæ•°æ®<a href="http://vision.stanford.edu/teaching/cs231n/assignment1.zip">åœ¨è¿™é‡Œè·å–</a>ã€‚</p>

<div class="highlight"><pre><code class="language-python"><span class="n">__author__</span> <span class="o">=</span> <span class="s">&#39;jiyeqian&#39;</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">cs231n.data_utils</span> <span class="kn">import</span> <span class="n">load_CIFAR10</span>

<span class="c"># a magic function we provide</span>
<span class="n">Xtr</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">Xte</span><span class="p">,</span> <span class="n">Yte</span> <span class="o">=</span> <span class="n">load_CIFAR10</span><span class="p">(</span><span class="s">&#39;cs231n/datasets/cifar-10-batches-py&#39;</span><span class="p">)</span>
<span class="c"># Subsample the data for more efficient code execution</span>
<span class="n">num_training</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="n">mask</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_training</span><span class="p">)</span>
<span class="n">Xtr</span><span class="p">,</span> <span class="n">Ytr</span> <span class="o">=</span> <span class="n">Xtr</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">Ytr</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="n">num_test</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">mask</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_test</span><span class="p">)</span>
<span class="n">Xte</span><span class="p">,</span> <span class="n">Yte</span> <span class="o">=</span> <span class="n">Xte</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">Yte</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

<span class="c"># flatten out all images to be one-dimensional</span>
<span class="n">Xtr_rows</span> <span class="o">=</span> <span class="n">Xtr</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Xtr</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="c"># Xtr_rows becomes 5000 x 3072</span>
<span class="n">Xte_rows</span> <span class="o">=</span> <span class="n">Xte</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">Xte</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">32</span> <span class="o">*</span> <span class="mi">3</span><span class="p">)</span> <span class="c"># Xte_rows becomes 500 x 3072</span>

<span class="k">class</span> <span class="nc">NearestNeighbor</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; X is N x D where each row is an example. Y is 1-dimension of size N &quot;&quot;&quot;</span>
        <span class="c"># the nearest neighbor classifier simply remembers all the training data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Xtr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytr</span> <span class="o">=</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span>

    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; X is N x D where each row is an example we wish to predict label for &quot;&quot;&quot;</span>
        <span class="n">num_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c"># lets make sure that the output type matches the input type</span>
        <span class="n">Ypred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_test</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ytr</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>

        <span class="c"># loop over all test rows</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">num_test</span><span class="p">):</span>
            <span class="c"># find the nearest training image to the i&#39;th test image</span>
            <span class="c"># using the L1 distance (sum of absolute value differences)</span>
            <span class="n">distances</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Xtr</span> <span class="o">-</span> <span class="n">X</span><span class="p">[</span><span class="n">i</span><span class="p">,:]),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c"># L2 distance</span>
            <span class="c"># distances = np.linalg.norm(self.Xtr - X[i,:], axis = 1)</span>
            <span class="c"># min_index = np.argmin(distances) # get the index with smallest distance</span>
            <span class="c"># Ypred[i] = self.ytr[min_index] # predict the label of the nearest example</span>
            <span class="n">fre_idx</span><span class="p">,</span> <span class="n">fre_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ytr</span><span class="p">[</span><span class="n">distances</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="n">k</span><span class="p">]],</span> \
                                         <span class="n">return_counts</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">Ypred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fre_idx</span><span class="p">[</span><span class="n">fre_num</span> <span class="o">==</span> <span class="n">fre_num</span><span class="o">.</span><span class="n">max</span><span class="p">()]</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">Ypred</span>


<span class="c"># Part 1: kNN prediction</span>

<span class="n">nn</span> <span class="o">=</span> <span class="n">NearestNeighbor</span><span class="p">()</span> <span class="c"># create a Nearest Neighbor classifier class</span>
<span class="n">nn</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">Xtr_rows</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">)</span> <span class="c"># train the classifier on the training images and labels</span>
<span class="n">Yte_predict</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xte_rows</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c"># predict labels on the test images</span>
<span class="c"># and now print the classification accuracy, which is the average number</span>
<span class="c"># of examples that are correctly predicted (i.e. label matches)</span>
<span class="k">print</span> <span class="s">&#39;accuracy: </span><span class="si">%f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Yte_predict</span> <span class="o">==</span> <span class="n">Yte</span><span class="p">)</span> <span class="p">)</span>


<span class="c"># Part 2: validation for choosing k</span>

<span class="c"># assume we have Xtr_rows, Ytr, Xte_rows, Yte as before</span>
<span class="c"># recall Xtr_rows is 5,000 x 3072 matrix</span>
<span class="n">Xval_rows</span><span class="p">,</span> <span class="n">Yval</span> <span class="o">=</span> <span class="n">Xtr_rows</span><span class="p">[:</span><span class="mi">1000</span><span class="p">,</span> <span class="p">:],</span> <span class="n">Ytr</span><span class="p">[:</span><span class="mi">1000</span><span class="p">]</span><span class="c"># take first 1000 for validation</span>
<span class="n">Xtr_rows</span><span class="p">,</span> <span class="n">Ytr</span> <span class="o">=</span> <span class="n">Xtr_rows</span><span class="p">[</span><span class="mi">1000</span><span class="p">:,</span> <span class="p">:],</span> <span class="n">Ytr</span><span class="p">[</span><span class="mi">1000</span><span class="p">:]</span> <span class="c"># keep last 4,000 for train</span>

<span class="c"># find hyperparameters that work best on the validation set</span>
<span class="n">validation_accuracies</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">]:</span>

    <span class="c"># use a particular value of k and evaluation on validation data</span>
    <span class="n">nn</span> <span class="o">=</span> <span class="n">NearestNeighbor</span><span class="p">()</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">Xtr_rows</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">)</span>
    <span class="c"># here we assume a modified NearestNeighbor class that can take a k as input</span>
    <span class="n">Yval_predict</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">Xval_rows</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">Yval_predict</span> <span class="o">==</span> <span class="n">Yval</span><span class="p">)</span>
    <span class="k">print</span> <span class="s">&#39;accuracy: </span><span class="si">%f</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">acc</span><span class="p">,)</span>

    <span class="c"># keep track of what works on the validation set</span>
    <span class="n">validation_accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">acc</span><span class="p">))</span></code></pre></div>

<p>kæœ€è¿‘é‚»ç®—æ³•é¢„æµ‹é˜¶æ®µè®¡ç®—å¤æ‚åº¦éå¸¸é«˜ï¼Œä¸ºäº†åŠ å¿«è®¡ç®—é€Ÿåº¦ï¼Œä¸Šè¿°ä»£ç åªæŠ½å–äº†10%çš„æ•°æ®ï¼Œå¾—åˆ°çš„ç»“æœå¦‚ä¸‹ï¼š</p>

<div class="highlight"><pre><code># Part 1:
accuracy: 0.290000
# Part 2:
accuracy: 0.291000
accuracy: 0.269000
accuracy: 0.275000
accuracy: 0.289000
accuracy: 0.287000
accuracy: 0.285000
accuracy: 0.283000
</code></pre></div>

<h2 id="section-5">çº¿æ€§åˆ†ç±»å™¨</h2>

<p><img src="/assets/images/2016-03-14-cs231n_image_classification_pipeline_image-caption-model.jpg" alt="" id="fig-10" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>å›¾åƒæ ‡æ³¨ç³»ç»Ÿï¼ˆCNN ä¸ RNN çš„ç»“åˆï¼‰</strong></p>

<p>ä¸æœ€è¿‘é‚»æ–¹æ³•ä¸åŒï¼Œçº¿æ€§åˆ†ç±»å™¨æ˜¯ä¸€ç§å‚æ•°åŒ–æ–¹æ³•ï¼ˆParametric Approachï¼‰ã€‚</p>

<p><img src="/assets/images/2016-03-14-cs231n_image_classification_pipeline_Linear-classifier1.png" alt="" width="400px" id="fig-11" /></p>

<hr class="mvgcv-figure-caption align-text-center" />

<p><img src="/assets/images/2016-03-14-cs231n_image_classification_pipeline_Linear-classifier2.png" alt="" width="400px" id="fig-12" /></p>

<p class="mvgcv-figure-caption align-text-center"><strong>çº¿æ€§åˆ†ç±»å™¨è®¡ç®—è¿‡ç¨‹</strong></p>

<p>è¾“å…¥å›¾åƒå±äºå¾—åˆ†æœ€é«˜çš„ç±»åˆ«ï¼Œä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒğŸ±çš„å¾—åˆ†ä¸ºè´Ÿï¼Œæ˜¾ç„¶ä¼šè¢«é”™åˆ†ç±»ï¼Œåˆ†ç±»å™¨çš„å‚æ•°å¹¶ä¸åˆé€‚<sup id="fnref:unbalanced-data-lc"><a href="#fn:unbalanced-data-lc" class="footnote">4</a></sup>ã€‚</p>

<h2 id="section-6">å‚è€ƒæ–‡çŒ®</h2>

<ol class="bibliography"></ol>

<div class="footnotes">
  <ol>
    <li id="fn:what-is-kaggle-score">
      <p>kaggleæ’åçš„å¾—åˆ†ï¼ˆscoreï¼‰æ˜¯å¦‚ä½•è®¡ç®—çš„ï¼Ÿ <a href="#fnref:what-is-kaggle-score" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:think1">
      <p>NN å’Œ kNN ï¼ˆé‡‡ç”¨$L_1$æˆ–$L_2$è·ç¦»ï¼‰åœ¨<strong>è®­ç»ƒé›†</strong>ä¸Šæµ‹è¯•çš„ç²¾åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ <a href="#fnref:think1" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:why-not-here">
      <p>We will cover this in more detail in later sections, and chose not to cover data normalization in this section because pixels in images are usually homogeneous and do not exhibit widely different distributions, alleviating the need for data normalization. <a href="#fnref:why-not-here" class="reversefootnote">&#8617;</a></p>
    </li>
    <li id="fn:unbalanced-data-lc">
      <p>ä¸å¹³è¡¡æ•°æ®é›†å¯¹çº¿æ€§åˆ†ç±»å™¨çš„æ€§èƒ½æœ‰ä½•å½±å“ï¼Ÿ <a href="#fnref:unbalanced-data-lc" class="reversefootnote">&#8617;</a></p>
    </li>
  </ol>
</div>

</section>
<section align="left">
<p></p>
<hr>
  <p><img/ src="/assets/images/alipay2me.png" alt="æ‰“èµä½œè€…" style="height: 160px"></p>
  <p></p>
<hr>
  <ul>
    
    <li class="pageNav">2016-11-19 &raquo; <a href="/2016/11/ccf-bigdata-competition-about-state-grid">CCF å›½å®¶ç”µç½‘å¤§æ•°æ®ç«èµ›</a></li>
    
    <li class="pageNav">2016-10-24 &raquo; <a href="/2016/10/nnml-bp-learning">NNMLï¼ˆ03ï¼‰ï¼šBP å­¦ä¹ </a></li>
    
    <li class="pageNav">2016-10-16 &raquo; <a href="/2016/10/nnml-perceptron-learning">NNMLï¼ˆ02ï¼‰ï¼šæ„ŸçŸ¥å™¨å­¦ä¹ </a></li>
    
    <li class="pageNav">2016-10-09 &raquo; <a href="/2016/10/s13000-model">é²æ£’åŠè‡ªé€‚åº”æ§åˆ¶ï¼ˆ2ï¼‰ï¼šæ¨¡å‹</a></li>
    
    <li class="pageNav">2016-10-09 &raquo; <a href="/2016/10/nnml_introduction">NNMLï¼ˆ01ï¼‰ï¼šå¼•è¨€</a></li>
    
    <li class="pageNav">2016-09-24 &raquo; <a href="/2016/09/feasibility-about-home-camera-in-power-syetem-monitoring">å®¶ç”¨ç›‘æ§è®¾å¤‡ç”¨äºç”µç½‘çš„å¯è¡Œæ€§åˆ†æ</a></li>
    
    <li class="pageNav">2016-09-19 &raquo; <a href="/2016/09/feasibility-about-uav-in-cable-tunnel">æ— äººæœºç”µç¼†éš§é“å·¡æ£€å¯è¡Œæ€§è°ƒç ”æŠ¥å‘Š</a></li>
    
    <li class="pageNav">2016-09-18 &raquo; <a href="/2016/09/s13000-Introduction">é²æ£’åŠè‡ªé€‚åº”æ§åˆ¶ï¼ˆ1ï¼‰ï¼šæ¦‚è®º</a></li>
    
  </ul>
<p></p>
<span>
  <a  href="/2016/02/cs231n_introduction-to-computer-vision" class="pageNav" style="float:left"   >ä¸Šä¸€ç¯‡ï¼šCS231nï¼ˆ1ï¼‰ï¼šè®¡ç®—æœºè§†è§‰ç®€ä»‹ </a>
  &nbsp;&nbsp;&nbsp;
  <a  href="/2016/03/cs231n_loss-functions-and-optimization" class="pageNav" style="float:right"   >ä¸‹ä¸€ç¯‡ï¼šCS231nï¼ˆ3ï¼‰ï¼šæŸå¤±å‡½æ•°ä¸æœ€ä¼˜åŒ– </a>  
</span>
</section>

	<script type="text/javascript">
	var first_image = document.getElementsByClassName("post")[0].getElementsByTagName("img")[0]; 
	if (first_image != undefined) {
	document.getElementsByClassName("ds-thread")[0].setAttribute("data-image", first_image.src);
	}
	</script>
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"jiyeqian"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<ul class="ds-recent-visitors" data-num-items="16"></ul>
	<div class="ds-thread"  data-thread-key="/2016/03/cs231n_image-classification-pipeline" 	data-url="http://qianjiye.de/2016/03/cs231n_image-classification-pipeline" data-title="CS231nï¼ˆ2ï¼‰ï¼šå›¾åƒåˆ†ç±»æµç¨‹">
	</div>	


<!-- <script type="text/javascript"> -->
<!-- $(function(){ -->
<!--   $(document).keydown(function(e) { -->
<!--     var url = false; -->
<!--         if (e.which == 37 || e.which == 72) {  // Left arrow and H -->
<!--          -->
<!--         url = '/2016/02/cs231n_introduction-to-computer-vision'; -->
<!--          -->
<!--         } -->
<!--         else if (e.which == 39 || e.which == 76) {  // Right arrow and L -->
<!--          -->
<!--         <1!-- url = 'http://qianjiye.de/2016/03/cs231n_loss-functions-and-optimization'; --1> -->
<!--         url = '/2016/03/cs231n_loss-functions-and-optimization'; -->
<!--          -->
<!--         } else if (e.which == 75) {  // K -->
<!--           url = '#'; -->
<!--         } else if (e.which == 74) { // J -->
<!--         url = '/2016/03/cs231n_image-classification-pipeline/#timeSpan'; -->
<!--         } -->
<!--         if (url) { -->
<!--             window.location = url; -->
<!--         } -->
<!--   }); -->
<!-- }) -->
<!-- </script> -->

        </article>
      </div>

    <footer>
        <p><small>
            Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> | Copyright 2014 - 2016 by <a href="/about/">Jiye Qian</a> | <span class="label label-info" id="timeSpan"></span></small></p>
    </footer>

    </div>
  </body>
</html>
